import{r as t,j as l,u as N,d as $}from"./index-C3yAw1QS.js";import{I as W}from"./index-BcMU5-Xp.js";import{M as _,u as S,P as H,a as T,b as A,L as B,m as b}from"./proxy-5cOHysRx.js";class D extends t.Component{getSnapshotBeforeUpdate(d){const n=this.props.childRef.current;if(n&&d.isPresent&&!this.props.isPresent){const r=n.offsetParent,f=r instanceof HTMLElement&&r.offsetWidth||0,e=this.props.sizeRef.current;e.height=n.offsetHeight||0,e.width=n.offsetWidth||0,e.top=n.offsetTop,e.left=n.offsetLeft,e.right=f-e.width-e.left}return null}componentDidUpdate(){}render(){return this.props.children}}function F({children:c,isPresent:d,anchorX:n}){const r=t.useId(),f=t.useRef(null),e=t.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:x}=t.useContext(_);return t.useInsertionEffect(()=>{const{width:o,height:i,top:p,left:s,right:g}=e.current;if(d||!f.current||!o||!i)return;const m=n==="left"?`left: ${s}`:`right: ${g}`;f.current.dataset.motionPopId=r;const a=document.createElement("style");return x&&(a.nonce=x),document.head.appendChild(a),a.sheet&&a.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${i}px !important;
            ${m}px !important;
            top: ${p}px !important;
          }
        `),()=>{document.head.removeChild(a)}},[d]),l.jsx(D,{isPresent:d,childRef:f,sizeRef:e,children:t.cloneElement(c,{ref:f})})}const K=({children:c,initial:d,isPresent:n,onExitComplete:r,custom:f,presenceAffectsLayout:e,mode:x,anchorX:o})=>{const i=S(U),p=t.useId(),s=t.useCallback(m=>{i.set(m,!0);for(const a of i.values())if(!a)return;r&&r()},[i,r]),g=t.useMemo(()=>({id:p,initial:d,isPresent:n,custom:f,onExitComplete:s,register:m=>(i.set(m,!1),()=>i.delete(m))}),e?[Math.random(),s]:[n,s]);return t.useMemo(()=>{i.forEach((m,a)=>i.set(a,!1))},[n]),t.useEffect(()=>{!n&&!i.size&&r&&r()},[n]),x==="popLayout"&&(c=l.jsx(F,{isPresent:n,anchorX:o,children:c})),l.jsx(H.Provider,{value:g,children:c})};function U(){return new Map}const R=c=>c.key||"";function k(c){const d=[];return t.Children.forEach(c,n=>{t.isValidElement(n)&&d.push(n)}),d}const G=({children:c,custom:d,initial:n=!0,onExitComplete:r,presenceAffectsLayout:f=!0,mode:e="sync",propagate:x=!1,anchorX:o="left"})=>{const[i,p]=T(x),s=t.useMemo(()=>k(c),[c]),g=x&&!i?[]:s.map(R),m=t.useRef(!0),a=t.useRef(s),u=S(()=>new Map),[y,z]=t.useState(s),[C,I]=t.useState(s);A(()=>{m.current=!1,a.current=s;for(let w=0;w<C.length;w++){const h=R(C[w]);g.includes(h)?u.delete(h):u.get(h)!==!0&&u.set(h,!1)}},[C,g.length,g.join("-")]);const j=[];if(s!==y){let w=[...s];for(let h=0;h<C.length;h++){const v=C[h],M=R(v);g.includes(M)||(w.splice(h,0,v),j.push(v))}return e==="wait"&&j.length&&(w=j),I(k(w)),z(s),null}const{forceRender:E}=t.useContext(B);return l.jsx(l.Fragment,{children:C.map(w=>{const h=R(w),v=x&&!i?!1:s===C||g.includes(h),M=()=>{if(u.has(h))u.set(h,!0);else return;let P=!0;u.forEach(L=>{L||(P=!1)}),P&&(E==null||E(),I(a.current),x&&(p==null||p()),r&&r())};return l.jsx(K,{isPresent:v,initial:!m.current||n?void 0:!1,custom:d,presenceAffectsLayout:f,mode:e,onExitComplete:v?void 0:M,anchorX:o,children:w},h)})})},q=()=>{const c=N(),[d,n]=t.useState([]),[r,f]=t.useState(null),[e,x]=t.useState(window.innerWidth<768);return t.useEffect(()=>{const o=()=>x(window.innerWidth<768);return window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)},[]),t.useEffect(()=>{$.get("https://backend-headlight-shop.vercel.app/api/reviews").then(o=>{const i=[],p=e?100:180,s=15,g=200,m=()=>{let a=0,u;do u={x:Math.random()*(window.innerWidth-p-s),y:Math.random()*(window.innerHeight-p-s)},a++;while(i.some(y=>Math.abs(y.x-u.x)<p+s&&Math.abs(y.y-u.y)<p+s)&&a<g);return u};n(o.data.map(a=>{const u=e?{}:m();return e||i.push(u),{url:a,...u}}))}).catch(o=>console.error("Помилка отримання зображень",o))},[e]),l.jsxs(l.Fragment,{children:[l.jsxs("button",{className:"btn-back",onClick:()=>c("/"),children:[l.jsx(W,{})," Hа головну"]}),l.jsxs("div",{className:"reviews",children:[l.jsx("h2",{className:"reviews__title",children:"Відгуки користувачів"}),l.jsx("div",{className:`reviews__list ${e?"mobile":""}`,children:d.map((o,i)=>l.jsx(b.img,{src:o.url,alt:"Review Screenshot",className:"review-img",onClick:()=>f(o.url),width:e?"100%":180,style:e?{}:{position:"absolute",left:o.x,top:o.y},animate:e?{}:{rotate:[0,1,-1,0]},transition:e?{}:{rotate:{repeat:1/0,duration:2,repeatType:"mirror"}}},i))}),l.jsx(G,{children:r&&l.jsx(b.div,{className:"modal",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>f(null),children:l.jsx(b.img,{src:r,alt:"Selected Review",className:"modal-img",initial:{scale:.5,y:100},animate:{scale:1,y:0},exit:{scale:.5,y:100}})})})]})]})};export{q as default};
