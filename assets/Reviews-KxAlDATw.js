import{r as e,j as c,u as $,d as L}from"./index-Cn-a6OHt.js";import{I as W}from"./index-DZrVFhuV.js";import{M as _,u as b,P as H,a as T,b as A,L as B,m as E}from"./proxy-EXbU7zV2.js";class D extends e.Component{getSnapshotBeforeUpdate(u){const t=this.props.childRef.current;if(t&&u.isPresent&&!this.props.isPresent){const r=t.offsetParent,f=r instanceof HTMLElement&&r.offsetWidth||0,s=this.props.sizeRef.current;s.height=t.offsetHeight||0,s.width=t.offsetWidth||0,s.top=t.offsetTop,s.left=t.offsetLeft,s.right=f-s.width-s.left}return null}componentDidUpdate(){}render(){return this.props.children}}function F({children:l,isPresent:u,anchorX:t}){const r=e.useId(),f=e.useRef(null),s=e.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:o}=e.useContext(_);return e.useInsertionEffect(()=>{const{width:m,height:i,top:p,left:a,right:x}=s.current;if(u||!f.current||!m||!i)return;const d=t==="left"?`left: ${a}`:`right: ${x}`;f.current.dataset.motionPopId=r;const n=document.createElement("style");return o&&(n.nonce=o),document.head.appendChild(n),n.sheet&&n.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${m}px !important;
            height: ${i}px !important;
            ${d}px !important;
            top: ${p}px !important;
          }
        `),()=>{document.head.removeChild(n)}},[u]),c.jsx(D,{isPresent:u,childRef:f,sizeRef:s,children:e.cloneElement(l,{ref:f})})}const K=({children:l,initial:u,isPresent:t,onExitComplete:r,custom:f,presenceAffectsLayout:s,mode:o,anchorX:m})=>{const i=b(U),p=e.useId(),a=e.useCallback(d=>{i.set(d,!0);for(const n of i.values())if(!n)return;r&&r()},[i,r]),x=e.useMemo(()=>({id:p,initial:u,isPresent:t,custom:f,onExitComplete:a,register:d=>(i.set(d,!1),()=>i.delete(d))}),s?[Math.random(),a]:[t,a]);return e.useMemo(()=>{i.forEach((d,n)=>i.set(n,!1))},[t]),e.useEffect(()=>{!t&&!i.size&&r&&r()},[t]),o==="popLayout"&&(l=c.jsx(F,{isPresent:t,anchorX:m,children:l})),c.jsx(H.Provider,{value:x,children:l})};function U(){return new Map}const w=l=>l.key||"";function k(l){const u=[];return e.Children.forEach(l,t=>{e.isValidElement(t)&&u.push(t)}),u}const G=({children:l,custom:u,initial:t=!0,onExitComplete:r,presenceAffectsLayout:f=!0,mode:s="sync",propagate:o=!1,anchorX:m="left"})=>{const[i,p]=T(o),a=e.useMemo(()=>k(l),[l]),x=o&&!i?[]:a.map(w),d=e.useRef(!0),n=e.useRef(a),C=b(()=>new Map),[S,N]=e.useState(a),[y,I]=e.useState(a);A(()=>{d.current=!1,n.current=a;for(let g=0;g<y.length;g++){const h=w(y[g]);x.includes(h)?C.delete(h):C.get(h)!==!0&&C.set(h,!1)}},[y,x.length,x.join("-")]);const j=[];if(a!==S){let g=[...a];for(let h=0;h<y.length;h++){const v=y[h],M=w(v);x.includes(M)||(g.splice(h,0,v),j.push(v))}return s==="wait"&&j.length&&(g=j),I(k(g)),N(a),null}const{forceRender:R}=e.useContext(B);return c.jsx(c.Fragment,{children:y.map(g=>{const h=w(g),v=o&&!i?!1:a===y||x.includes(h),M=()=>{if(C.has(h))C.set(h,!0);else return;let P=!0;C.forEach(z=>{z||(P=!1)}),P&&(R==null||R(),I(n.current),o&&(p==null||p()),r&&r())};return c.jsx(K,{isPresent:v,initial:!d.current||t?void 0:!1,custom:u,presenceAffectsLayout:f,mode:s,onExitComplete:v?void 0:M,anchorX:m,children:g},h)})})},q=()=>{const l=$(),[u,t]=e.useState([]),[r,f]=e.useState(null),s=window.innerWidth<768;return e.useEffect(()=>{L.get("https://backend-headlight-shop.vercel.app/api/reviews").then(o=>{const m=[],i=s?120:180,p=15,a=200,x=()=>{let d=0,n;do n={x:Math.random()*(window.innerWidth-i-p),y:Math.random()*(window.innerHeight-i-p)},d++;while(m.some(C=>Math.abs(C.x-n.x)<i+p&&Math.abs(C.y-n.y)<i+p)&&d<a);return n};t(o.data.map(d=>{const n=x();return m.push(n),{url:d,...n}}))}).catch(o=>console.error("Помилка отримання зображень",o))},[]),c.jsxs(c.Fragment,{children:[c.jsxs("button",{className:"btn-back",onClick:()=>l("/"),children:[c.jsx(W,{})," Hа головну"]}),c.jsxs("div",{className:"reviews",children:[c.jsx("h2",{className:"reviews__title",children:"Відгуки користувачів"}),c.jsx("div",{className:"reviews__list",children:u.map((o,m)=>c.jsx(E.img,{src:o.url,alt:"Review Screenshot",width:s?120:180,className:"review-img",onClick:()=>f(o.url),initial:{x:o.x,y:o.y},animate:{rotate:[0,1,-1,0]},transition:{rotate:{repeat:1/0,duration:2,repeatType:"mirror"}}},m))}),c.jsx(G,{children:r&&c.jsx(E.div,{className:"modal",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>f(null),children:c.jsx(E.img,{src:r,alt:"Selected Review",className:"modal-img",initial:{scale:.5,y:100},animate:{scale:1,y:0},exit:{scale:.5,y:100},style:{maxWidth:s?"90%":"60%"}})})})]})]})};export{q as default};
